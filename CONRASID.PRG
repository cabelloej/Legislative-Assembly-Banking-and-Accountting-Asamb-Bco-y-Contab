STORE 0     TO WPAGINA
STORE 100   TO WLINEA
IF WSALIDA = 1
   STORE 18 TO WSALTO
   @ 0,0 CLEAR
ELSE
   SET DEVI TO PRINT
   STORE 55 TO WSALTO
ENDIF
***
STORE "N" TO WTIPFILTRO
SELECT &WARCGEN
GO TOP
IF WCODCOMINI<>REPLICATE("0",LEN(WCODCOMINI))
   STORE "C" TO WTIPFILTRO
   SET ORDER TO &WINDGEN1
   SEEK WCODCOMINI
   IF .NOT.FOUND()
      GO TOP
      DO WHILE.NOT.EOF()
         IF WCODCOMINI>=CODCOMG
            EXIT
         ENDIF
         SKIP
      ENDDO
   ENDIF
ELSE
   IF WFECCOMINI<>CTOD("  -  -    ")
      STORE "F" TO WTIPFILTRO
      SET ORDER TO &WINDGEN2
      SEEK WFECCOMINI
      IF .NOT.FOUND()
         GO TOP
         DO WHILE.NOT.EOF()
            IF WFECCOMINI>=FECCOMG
               EXIT
            ENDIF
            SKIP
         ENDDO
      ENDIF
   ENDIF
ENDIF
***
DO SALTOH
DO WHILE.NOT.EOF()
   IF WTIPFILTRO="N"
      * TODO PASA
   ELSE
      IF WTIPFILTRO="C"
         IF CODCOMG>WCODCOMFIN
            EXIT
         ENDIF
      ELSE
         IF FECCOMG>WFECCOMFIN
            EXIT
         ENDIF
      ENDIF
   ENDIF
   STORE CODCOMG TO WCODCOMR
   STORE FECCOMG TO WFECCOMR
   STORE DESCOM1 TO WDESCOMR1
   STORE DESCOM2 TO WDESCOMR2
   STORE DESCOM3 TO WDESCOMR2
   STORE DESCOM4 TO WDESCOMR2
   STORE DESCOM5 TO WDESCOMR2
   STORE DESCOM6 TO WDESCOMR2
   STORE DESCOM7 TO WDESCOMR2
   STORE DESCOM8 TO WDESCOMR2
   STORE DESCOM9 TO WDESCOMR2
   STORE DESCOM10 TO WDESCOMR2
   STORE DESCOM11 TO WDESCOMR2
   STORE DESCOM12 TO WDESCOMR2
   STORE DESCOM13 TO WDESCOMR2
   STORE DESCOM14 TO WDESCOMR2
   STORE DESCOM15 TO WDESCOMR2
   STORE 0       TO WTOTDEBE
   STORE 0       TO WTOTHABER
   STORE 0       TO WSALDO
   IF WSEPARAR=2
      STORE 100 TO WLINEA
   ENDIF
   DO SALTOH
   DO SALTOG
   SELECT &WARCDET
   SET ORDER TO &WINDDET1
   SEEK WCODCOMR
   DO WHILE.NOT.EOF().AND.CODCOMD=WCODCOMR
      STORE WLINEA+2 TO WLINEA
      DO SALTOH
      @ WLINEA,00  SAY CODCTA
      IF DETCTA1<>SPACE(LEN(DETCTA1))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA1
      ENDIF
      IF DETCTA2<>SPACE(LEN(DETCTA2))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA2
      ENDIF
      IF DETCTA3<>SPACE(LEN(DETCTA3))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA3
      ENDIF
      IF DETCTA4<>SPACE(LEN(DETCTA4))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA4
      ENDIF
      IF DETCTA5<>SPACE(LEN(DETCTA5))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA5
      ENDIF
      IF DETCTA6<>SPACE(LEN(DETCTA6))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA6
      ENDIF
      IF DETCTA7<>SPACE(LEN(DETCTA7))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA7
      ENDIF
      IF DETCTA8<>SPACE(LEN(DETCTA8))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA8
      ENDIF
      IF DETCTA9<>SPACE(LEN(DETCTA9))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA9
      ENDIF
      IF DETCTA10<>SPACE(LEN(DETCTA10))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA10
      ENDIF
      IF DETCTA11<>SPACE(LEN(DETCTA11))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA11
      ENDIF
      IF DETCTA12<>SPACE(LEN(DETCTA12))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA12
      ENDIF
      IF DETCTA13<>SPACE(LEN(DETCTA13))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA13
      ENDIF
      IF DETCTA14<>SPACE(LEN(DETCTA14))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA14
      ENDIF
      IF DETCTA15<>SPACE(LEN(DETCTA15))
         STORE WLINEA+1 TO WLINEA
         DO SALTOH
         @ WLINEA,00  SAY DETCTA15
      ENDIF
      @ WLINEA,32  SAY DOCTO
      @ WLINEA,45  SAY DEBE       PICT "@Z 999,999,999.99"
      @ WLINEA,65  SAY HABER      PICT "@Z 999,999,999.99"
      STORE WTOTDEBE+DEBE   TO WTOTDEBE
      STORE WTOTHABER+HABER TO WTOTHABER
      SELECT &WARCDET
      SKIP
   ENDDO
   DO TOTALASI
   SELECT &WARCGEN
   SKIP
ENDDO
IF WSALIDA=2
   SET DEVI TO SCRE
   EJECT
ELSE
   STORE "OPRIMA (Ù) PARA FINALIZAR" TO WTEXT
   STORE CHR(13) TO WCH
   DO PREGUNTA
   @ 0,0 CLEAR
ENDIF
SHOW MENU MENUCON
RETURN
********************************************************************************
***********
PROC SALTOH
***********
IF WLINEA >= WSALTO
   STORE WPAGINA + 1 TO WPAGINA
   IF WSALIDA=1 .AND. WPAGINA<>1
      STORE "OPRIMA (Ù) PARA CONTINUAR" TO WTEXT
      STORE CHR(13) TO WCH
      DO PREGUNTA
      @ 0,0 CLEAR
   ENDIF
   STORE 1 TO WLINEA
   IF WSALIDA=2
      @ 00,00  SAY CHR(14)+QQWW
   ELSE
      @ 00,00  SAY QQWW
   ENDIF
   @ 01,00 SAY "REPORTE DE COMPROBANTES "+WTIPASIDES
   @ 01,62 SAY "Fecha :"+DTOC(DATE())
   @ 02,62 SAY "Pagina:"+ALLTRIM(STR(WPAGINA,3))
   STORE 3 TO WLINEA
ENDIF
RETURN

***********
PROC SALTOG
***********
STORE WLINEA+1 TO WLINEA
DO SALTOH
@ WLINEA,00 SAY REPLICATE("-",80)
STORE WLINEA+1 TO WLINEA
DO SALTOH
@ WLINEA,00 SAY REPLICATE("-",80)
STORE WLINEA+1 TO WLINEA
DO SALTOH
@ WLINEA,00 SAY "NUMERO: "+WCODCOMR
@ WLINEA,20 SAY "DESCRIPCION: "+WDESCOMR1
STORE WLINEA+1 TO WLINEA
@ WLINEA,00 SAY "FECHA : "+DTOC(WFECCOMR)
@ WLINEA,20 SAY "             "+WDESCOMR2
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR3
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR4
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR5
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR6
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR7
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR8
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR9
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR10
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR11
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR12
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR13
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR14
STORE WLINEA+1 TO WLINEA
@ WLINEA,20 SAY "             "+WDESCOMR15
STORE WLINEA+1 TO WLINEA
DO SALTOH
@ WLINEA,00 SAY REPLICATE(".",80)
STORE WLINEA+1 TO WLINEA
DO SALTOH
@ WLINEA,00 SAY "CUENTA"
@ WLINEA,32 SAY "DOCUMENTO "
@ WLINEA,45 SAY "           DEBE"
@ WLINEA,65 SAY "          HABER"
STORE WLINEA+1 TO WLINEA
DO SALTOH
@ WLINEA,00 SAY REPLICATE(".",80)
RETURN

*************
PROC TOTALASI
*************
STORE WTOTDEBE-WTOTHABER TO WSALDO
STORE WLINEA+1 TO WLINEA
@ WLINEA,45 SAY "=============="
@ WLINEA,65 SAY "=============="
STORE WLINEA+1 TO WLINEA
IF WSALDO>0
   @ WLINEA,32  SAY "Saldo:"
   @ WLINEA,45  SAY WSALDO
ELSE
   IF WSALDO<0
      @ WLINEA,32  SAY "Saldo:"
      @ WLINEA,45  SAY WSALDO
   ENDIF
ENDIF
RETURN
