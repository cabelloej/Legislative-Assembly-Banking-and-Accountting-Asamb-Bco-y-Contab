STORE RTRIM(WCLAVE) TO WCLAVE
STORE 0   TO WPAGINA
STORE 100 TO WLINEA
IF WSALIDA = 1
   STORE 20 TO WSALTO
   @ 0,0 CLEAR
ELSE
   SET DEVI TO PRINT
   STORE 55 TO WSALTO
ENDIF

SELECT CONCTAS
GO TOP
DO WHILE .NOT. EOF()
   IF WCLAVE<>SPACE(LEN(WCLAVE)).AND.WCLAVE<>SUBSTR(CODCTA,1,LEN(WCLAVE))
      SELECT CONCTAS
      SKIP
      LOOP
   ENDIF
   STORE WLINEA+1 TO WLINEA
   DO SALTO
   @ WLINEA,00  SAY CODCTA
   @ WLINEA,19  SAY DESCTA1
   @ WLINEA,51  SAY GM
   @ WLINEA,54  SAY DEBE  PICTURE "@Z 999999999.99"
   @ WLINEA,68  SAY HABER PICTURE "@Z 999999999.99"
   IF DESCTA2<>SPACE(LEN(DESCTA2))
      STORE WLINEA+1 TO WLINEA
      @ WLINEA,22  SAY DESCTA2
   ENDIF
   SELECT CONCTAS
   SKIP
ENDDO
IF WSALIDA=2
   SET DEVI TO SCRE
   EJECT
ELSE
   STORE "OPRIMA (Ù) PARA FINALIZAR" TO WTEXT
   STORE CHR(13) TO WCH
   DO PREGUNTA
   @ 0,0 CLEAR
ENDIF
SHOW MENU MENUCON
RETURN
********************************************************************************
**********
PROC SALTO
**********
IF WLINEA >= WSALTO
   STORE WPAGINA + 1 TO WPAGINA
   IF WSALIDA=1 .AND. WPAGINA<>1
      STORE "OPRIMA (Ù) PARA CONTINUAR" TO WTEXT
      STORE CHR(13) TO WCH
      DO PREGUNTA
      @ 0,0 CLEAR
   ENDIF
   STORE 1 TO WLINEA
   IF WSALIDA=2
      @ 00,00  SAY CHR(14)+QQWW
   ELSE
      @ 00,00  SAY QQWW
   ENDIF
   @ 01,00 SAY "REPORTE DE CUENTAS"
   @ 01,70 SAY "Pag."+ALLTRIM(STR(WPAGINA,3))
   @ 03,00 SAY "CODIGO"
   @ 03,19 SAY "DESCRIPCION"
   @ 03,51 SAY "GM"
  *@ 03,54 SAY "        DEBE"
  *@ 03,68 SAY "       HABER"
   @ 04,00 SAY REPLICATE("-",80)
   STORE 5 TO WLINEA
ENDIF
RETURN
